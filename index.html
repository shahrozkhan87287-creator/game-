<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Neon Runner ‚Äî by Shahroz Khan</title>
<meta name="description" content="Fast, neon-styled endless runner with power-ups and high score.">
<style>
  :root{
    --bg1:#0a0b1a; --bg2:#121532; --glow:#6cf; --accent:#ff6b9a; --accent2:#7cffc4; --panel:#ffffff12;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    color:#eaf1ff;
    background:
      radial-gradient(800px 600px at 20% 10%, #18204a 0%, transparent 60%),
      radial-gradient(900px 900px at 80% 90%, #161a3b 0%, transparent 60%),
      linear-gradient(135deg,var(--bg1),var(--bg2));
    overflow:hidden;
  }

  /* Frame */
  .wrap{max-width:980px;margin:12px auto;padding:0 12px}
  #game{display:block; width:100%; height:auto; background:#0b0f24; border:1px solid #ffffff22; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,.6)}

  /* HUD */
  .hud{
    position:fixed; left:50%; transform:translateX(-50%); top:10px; display:flex; gap:10px; flex-wrap:wrap; z-index:3
  }
  .pill{background:var(--panel); border:1px solid #ffffff26; border-radius:12px; padding:8px 12px; font-weight:800}
  .btn{appearance:none;border:none;cursor:pointer; color:#111; font-weight:900; padding:10px 14px; border-radius:12px;
       background:linear-gradient(135deg,#7cffc4,#6cf); box-shadow:0 10px 24px rgba(0,0,0,.35)}
  .btn:active{transform:scale(.98)}

  /* Overlay */
  #overlay{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:4;
            backdrop-filter: blur(8px); background:#0a0c20cc }
  .panel{ background:#0c1128; border:1px solid #ffffff26; border-radius:16px; padding:18px; width:min(680px,92vw);
          box-shadow:0 24px 60px rgba(0,0,0,.6); text-align:center }
  .title{font-size:clamp(24px,5vw,36px); margin:0 0 6px}
  .muted{opacity:.9}
  .credit{ position:fixed; right:10px; bottom:10px; z-index:3; background:#0006; border:1px solid #ffffff22; border-radius:10px; padding:6px 10px; font-weight:800}

  /* Mobile Controls */
  .touch{ position:fixed; inset:auto 0 10px 0; display:flex; justify-content:space-between; padding:0 10px; z-index:3; pointer-events:none }
  .tbtn{ pointer-events:auto; touch-action:none; user-select:none; width:68px; height:68px; display:grid; place-items:center;
         background:#0007; border:1px solid #ffffff22; border-radius:18px; font-size:26px }
  .rightBtns{display:flex; gap:10px}
  @media (min-width:900px){ .touch{display:none} }

  @media (prefers-reduced-motion: reduce){
    *{animation:none!important; transition:none!important}
  }
</style>
</head>
<body>
  <div class="wrap">
    <canvas id="game" width="980" height="560" aria-label="Neon Runner canvas"></canvas>
  </div>

  <div class="hud">
    <div class="pill">Score: <span id="score">0</span></div>
    <div class="pill">Best: <span id="best">0</span></div>
    <div class="pill">Speed: <span id="spd">0</span></div>
    <button class="btn" id="pause">Pause</button>
    <button class="btn" id="how">How to Play</button>
  </div>

  <div class="credit">Created by <b>Shahroz Khan</b> ‚ú®</div>

  <!-- Mobile controls -->
  <div class="touch">
    <div class="rightBtns">
      <div class="tbtn" id="left">‚¨ÖÔ∏è</div>
      <div class="tbtn" id="right">‚û°Ô∏è</div>
    </div>
    <div class="rightBtns">
      <div class="tbtn" id="jump">‚§¥Ô∏è</div>
      <div class="tbtn" id="slomo">üê¢</div>
    </div>
  </div>

  <!-- Overlay -->
  <div id="overlay" hidden>
    <div class="panel">
      <h1 class="title">Neon Runner</h1>
      <p class="muted" id="ovText">
        Swipe lanes and jump over obstacles.<br>
        Collect <b>coins</b> for points, grab <b>shield</b> (üõ°Ô∏è) to survive a hit, and use <b>slow-mo</b> (üê¢) to chill for a moment.<br>
        Controls: <b>‚Üê ‚Üí</b> to change lanes, <b>Space/‚Üë</b> to jump. On mobile, use the on-screen buttons.
      </p>
      <div style="margin-top:12px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap">
        <button class="btn" id="play">Play</button>
        <button class="btn" id="restart" style="display:none">Restart</button>
        <button class="btn" id="close">Close</button>
      </div>
    </div>
  </div>

<script>
(() => {
  const cv = document.getElementById('game');
  const ctx = cv.getContext('2d');
  const scoreEl = document.getElementById('score');
  const bestEl  = document.getElementById('best');
  const spdEl   = document.getElementById('spd');
  const overlay = document.getElementById('overlay');
  const ovText  = document.getElementById('ovText');
  const playBtn = document.getElementById('play');
  const restartBtn = document.getElementById('restart');
  const pauseBtn = document.getElementById('pause');
  const howBtn  = document.getElementById('how');

  const keys = {left:false,right:false,up:false};
  const touch = {left:false,right:false,up:false,slomo:false};
  const lanesX = [cv.width*0.25, cv.width*0.5, cv.width*0.75]; // 3 lanes

  // mobile buttons
  bindTouch('#left','left'); bindTouch('#right','right'); bindTouch('#jump','up');
  document.getElementById('slomo').addEventListener('pointerdown',()=>{ if(state.slowmo<=0) state.slowmo=120; }, {passive:true});

  function bindTouch(sel, k){
    const el=document.querySelector(sel); if(!el) return;
    const on=()=>touch[k]=true, off=()=>touch[k]=false;
    ['pointerdown','touchstart'].forEach(e=>el.addEventListener(e,on,{passive:true}));
    ['pointerup','pointerleave','touchend','touchcancel'].forEach(e=>el.addEventListener(e,off,{passive:true}));
  }

  addEventListener('keydown',e=>{
    if(e.key==='ArrowLeft'||e.key==='a'||e.key==='A') keys.left=true;
    if(e.key==='ArrowRight'||e.key==='d'||e.key==='D') keys.right=true;
    if(e.key==='ArrowUp'||e.key==='w'||e.key==='W'||e.code==='Space') keys.up=true;
    if(e.key==='p'||e.key==='P') togglePause();
    if(e.key==='r'||e.key==='R') restart();
  });
  addEventListener('keyup',e=>{
    if(e.key==='ArrowLeft'||e.key==='a'||e.key==='A') keys.left=false;
    if(e.key==='ArrowRight'||e.key==='d'||e.key==='D') keys.right=false;
    if(e.key==='ArrowUp'||e.key==='w'||e.key==='W'||e.code==='Space') keys.up=false;
  });

  const best = +localStorage.getItem('neonBest') || 0; bestEl.textContent = best;

  // Game state
  const state = {
    running:false, paused:false, t:0,
    lane:1, // 0..2
    x: lanesX[1], y: cv.height-100, vy:0, onGround:true,
    score:0, speed:6, maxSpeed:16,
    shield:0, slowmo:0,
    particles:[],
    items:[], // obstacles & coins & powerups
  };

  function start(){
    state.running=true; state.paused=false; state.t=0;
    state.lane=1; state.x=lanesX[1]; state.y=cv.height-100; state.vy=0; state.onGround=true;
    state.score=0; state.speed=6; state.shield=0; state.slowmo=0;
    state.items.length=0; state.particles.length=0;
    overlay.hidden=true; restartBtn.style.display='none';
  }
  function gameOver(){
    state.running=false;
    const newBest = Math.max(best, state.score);
    if(newBest!==best){ localStorage.setItem('neonBest', newBest); bestEl.textContent=newBest; }
    ovText.innerHTML = `Final Score: <b>${state.score}</b><br>Best: <b>${Math.max(best, state.score)}</b><br><br>Tap Restart to try again.`;
    restartBtn.style.display='inline-block';
    overlay.hidden=false;
  }
  function restart(){ if(!state.running) { start(); } }

  function togglePause(){
    if(!state.running) return;
    state.paused = !state.paused;
    pauseBtn.textContent = state.paused ? 'Resume' : 'Pause';
  }

  // Entities
  function spawnObstacle(){
    const lane = Math.floor(Math.random()*3);
    state.items.push({type:'ob', lane, y:-40, w:36, h:36, emoji:'üöß'});
  }
  function spawnCoin(){
    const lane = Math.floor(Math.random()*3);
    state.items.push({type:'coin', lane, y:-40, r:14, emoji:'ü™ô'});
  }
  function spawnShield(){
    const lane = Math.floor(Math.random()*3);
    state.items.push({type:'shield', lane, y:-40, r:16, emoji:'üõ°Ô∏è'});
  }
  function spawnSlowmo(){
    const lane = Math.floor(Math.random()*3);
    state.items.push({type:'slow', lane, y:-40, r:16, emoji:'üê¢'});
  }

  function emit(x,y,clr){
    for(let i=0;i<10;i++){
      state.particles.push({x,y,vx:(Math.random()*2-1)*2,vy:(Math.random()*-2)-0.5,a:1,c:clr});
    }
  }

  function update(){
    if(!state.running || state.paused){ render(); return; }

    const laneTarget = (touch.left||keys.left) ? -1 : (touch.right||keys.right) ? 1 : 0;
    if(laneTarget!==0){
      state.lane = Math.max(0, Math.min(2, state.lane + laneTarget));
      state.x = lanesX[state.lane];
      // minor cooldown
      keys.left=keys.right=touch.left=touch.right=false;
    }

    // jump
    if((touch.up||keys.up) && state.onGround){
      state.vy = -14;
      state.onGround=false;
      keys.up=touch.up=false;
    }

    // gravity
    state.vy += 0.7;
    state.y += state.vy;
    if(state.y >= cv.height-100){
      state.y = cv.height-100; state.vy=0; state.onGround=true;
    }

    // difficulty & slowmo
    const slowFactor = state.slowmo>0 ? 0.4 : 1;
    if(state.slowmo>0) state.slowmo--;
    state.speed = Math.min(state.maxSpeed, state.speed + 0.002);

    // spawn logic
    state.t++;
    if(state.t % Math.floor(70*slowFactor) === 0) spawnObstacle();
    if(state.t % Math.floor(55*slowFactor) === 0) spawnCoin();
    if(state.t % Math.floor(600*slowFactor) === 0) spawnShield();
    if(state.t % Math.floor(500*slowFactor) === 0) spawnSlowmo();

    // move items
    for(const it of state.items){ it.y += state.speed * slowFactor * 1.2; }

    // collisions & cleanup
    const px = state.x, py = state.y;
    for(let i=state.items.length-1;i>=0;i--){
      const it = state.items[i];
      const ix = lanesX[it.lane];
      // off-screen
      if(it.y > cv.height+60){ state.items.splice(i,1); continue; }

      // check collision
      let hit=false;
      if(it.type==='ob'){
        const w=it.w,h=it.h;
        if(Math.abs(ix - px) < 28 && Math.abs(it.y - py) < 28){ hit=true; }
        if(hit){
          if(state.shield>0){
            state.shield=0; emit(px,py,'#7cffc4'); state.items.splice(i,1);
          }else{
            gameOver(); return;
          }
        }
      }else{
        // circles
        const r = it.r || 14;
        const d = Math.hypot(ix - px, it.y - py);
        if(d < r + 22){
          if(it.type==='coin'){
            state.score += 10; emit(ix,it.y,'#ffd166');
          }else if(it.type==='shield'){
            state.shield = 1; emit(ix,it.y,'#7cffc4');
          }else if(it.type==='slow'){
            state.slowmo = 140; emit(ix,it.y,'#6cf');
          }
          state.items.splice(i,1);
        }
      }
    }

    // score over time
    state.score += Math.floor(state.speed*0.6);
    // HUD
    scoreEl.textContent = state.score;
    spdEl.textContent   = Math.round(state.speed*10);
    render();
  }

  function render(){
    // background
    ctx.fillStyle = '#0b0f24'; ctx.fillRect(0,0,cv.width,cv.height);

    // road lanes glow
    for(let i=0;i<3;i++){
      const x = lanesX[i];
      ctx.strokeStyle = 'rgba(108, 207, 255, .35)'; ctx.lineWidth=2;
      ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, cv.height); ctx.stroke();
    }

    // items
    for(const it of state.items){
      const x = lanesX[it.lane], y = it.y;
      ctx.font = (it.type==='ob'? '28px' : '26px') + ' serif';
      ctx.textAlign='center'; ctx.textBaseline='middle';
      const emoji = it.emoji || 'ü™ô';
      ctx.fillText(emoji, x, y);
      if(it.type==='ob'){
        // neon outline
        ctx.strokeStyle='rgba(255,107,154,.25)'; ctx.strokeRect(x-18,y-18,36,36);
      }
    }

    // particles
    for(let i=state.particles.length-1;i>=0;i--){
      const p=state.particles[i]; p.x+=p.vx; p.y+=p.vy; p.a-=0.02;
      ctx.globalAlpha=Math.max(0,p.a); ctx.fillStyle=p.c;
      ctx.fillRect(p.x, p.y, 2.5, 2.5);
      ctx.globalAlpha=1;
      if(p.a<=0) state.particles.splice(i,1);
    }

    // player (neon disk + ring)
    const px = state.x, py = state.y;
    // trail
    ctx.fillStyle='rgba(124,255,196,0.08)';
    ctx.beginPath(); ctx.ellipse(px, py+20, 22, 8, 0, 0, Math.PI*2); ctx.fill();

    // body
    ctx.fillStyle= state.shield ? '#7cffc4' : '#6cf';
    ctx.beginPath(); ctx.arc(px, py, 20, 0, Math.PI*2); ctx.fill();
    // ring
    ctx.strokeStyle = state.shield ? 'rgba(124,255,196,.6)' : 'rgba(108,207,255,.6)';
    ctx.lineWidth=3; ctx.beginPath(); ctx.arc(px, py, 24, 0, Math.PI*2); ctx.stroke();
  }

  let raf, last=0;
  function loop(ts){
    if(!last) last=ts;
    const dt = (ts-last)/16.67; last=ts;
    for(let i=0;i<Math.max(1, Math.floor(dt)); i++) update();
    raf=requestAnimationFrame(loop);
  }
  raf=requestAnimationFrame(loop);

  // Buttons
  playBtn.onclick=()=>{ start(); };
  restartBtn.onclick=()=>{ start(); };
  document.getElementById('close').onclick=()=> overlay.hidden=true;
  howBtn.onclick=()=>{ overlay.hidden=false; };
  pauseBtn.onclick=togglePause;

  // Show help on first load
  overlay.hidden=false;

})();
</script>
</body>
</html>
